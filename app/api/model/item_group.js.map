{"version":3,"sources":["../../../src/api/model/item_group.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;IAEqB,S;;;;;;;;sBACnB,I,mBAAa;AAAA;;AAAA,sCAAL,IAAK;AAAL,UAAK;AAAA;;AACX,4CAAM,IAAN,iDAAc,IAAd;AACA,SAAK,QAAL,GAAgB;AACd,YAAM;AACJ,cAAM,MAAM,KAAN,CAAY,QADd;AAEJ,aAAI,IAFA;AAGJ,cAAK,OAHD;AAIJ,eAAO;AAJH;AADQ,KAAhB;AAQD,G;;sBAED,U,uBAAW,E,EACX;AACI,OAAG,QAAH;AACA,WAAO,KAAK,WAAL,CAAiB,IAAjB,EAAuB,KAAvB,CAA6B,UAAQ,EAArC,EAAyC,KAAzC,CAA+C,CAA/C,EAAkD,IAAlD,EAAP;AACH,G;;AAED;;;sBACA,O,sBAAS;AACP,WAAO,KAAK,WAAL,CAAiB,KAAjB,EAAwB,KAAxB,CAA8B,EAAC,QAAO,CAAR,EAA9B,EAA0C,KAA1C,CAAgD,eAAhD,EAAiE,MAAjE,EAAP;AACD,G;AACD;;;sBACM,Y;;;;;;;AACA,oB,GAAS,E;;qBACS,KAAK,OAAL,E;;;AAAlB,uB;uDACU,S;;;;;;;;AAAL,e;;qBACQ,KAAK,UAAL,CAAgB,UAAU,CAAV,EAAa,IAAb,CAAhB,C;;;AAAX,e;;AACJ,qBAAO,IAAP,CAAY,CAAZ;;;;;+CAEK,M;;;;;;;;;;;;;;;;;AAGT;;;sBACA,Y,2BAAc;AACZ,WAAO,KAAK,WAAL,CAAiB,KAAjB,EAAwB,KAAxB,CAA8B,eAA9B,EAA+C,MAA/C,EAAP;AACD,G;;sBAEK,S;6FAAU,I;;;;;;AACd,qBAAO,gBAAM,SAAN,YAAgB,IAAhB,CAAP;;qBACmB,KAAK,MAAL,E;;;AAAf,oB;;AACJ,mBAAK,EAAL,GAAU,OAAO,MAAP,CAAc,UAAC,GAAD,EAAM,IAAN;AAAA,uBAAa,MAAM,CAAC,KAAK,EAAZ,GAAiB,GAAjB,GAAuB,CAAC,KAAK,EAAN,IAAY,GAAhD;AAAA,eAAd,EAAmE,CAAnE,IAAwE,CAAlF;gDACO,I;;;;;;;;;;;;;;;;;;;;kBA3CU,S","file":"item_group.js","sourcesContent":["import Base from './base.js'\r\n\r\nexport default class ItemGroup extends Base {\r\n  init(...args){\r\n    super.init(...args);\r\n    this.relation = {\r\n      item: {\r\n        type: think.model.HAS_MANY,\r\n        key:\"id\",\r\n        fKey:\"group\",\r\n        order: \"createAt DESC\"\r\n      }\r\n    };\r\n  }\r\n\r\n  selectData(id)\r\n  {\r\n      id.toString();\r\n      return this.setRelation(true).where(\"id = \"+id).limit(8).find();\r\n  }\r\n\r\n  //获取首页显示的列表\r\n  getList(){\r\n    return this.setRelation(false).where({isOpen:1}).order(\"createAt DESC\").select();\r\n  }\r\n  //显示在首页的拍卖物品信息\r\n  async getGroupItem(){\r\n    let groups = [];\r\n    let itemGroup = await this.getList();\r\n    for (let i in itemGroup){\r\n      let g = await  this.selectData(itemGroup[i][\"id\"]);\r\n      groups.push(g);\r\n    }\r\n    return groups;\r\n  }\r\n\r\n  //管理员获取物品列表\r\n  getListAdmin(){\r\n    return this.setRelation(false).order(\"createAt DESC\").select();\r\n  }\r\n\r\n  async beforeAdd(data) {\r\n    data = super.beforeAdd(data);\r\n    let groups = await this.select();\r\n    data.no = groups.reduce((pre, curr)=>pre > +curr.no ? pre : +curr.no || pre, 0) + 1;\r\n    return data;\r\n  }\r\n}  "]}