{"version":3,"sources":["../../../src/api/model/image.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAI,MAAM,QAAQ,QAAR,CAAV;AACA;;;;;;;;;;;;mBAKQ,S;2FAAU,O;;;;;;;AACV,oB;;AACJ,kBAAI,EAAE,mBAAmB,KAArB,CAAJ,EACE,UAAU,CAAC,OAAD,CAAV;;qBACa,KAAK,KAAL,CAAW,EAAC,IAAI,CAAC,IAAD,EAAO,OAAP,CAAL,EAAX,EAAkC,MAAlC,E;;;AAAf,oB;0BACc,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAL,e;;AACP,gBAAE,UAAF,IAAgB,KAAK,aAAL,CAAmB,EAAE,MAAF,CAAnB,CAAhB;;;;;;;+CAEK,M;;;;;;;;;;;;;;;;;mBAGT,a,0BAAc,O,EAAS;AACrB,QAAI,MAAM,IAAI,KAAJ,CAAU,OAAV,CAAV;AACA,QAAI,IAAI,QAAJ,EAAc,WAAd,MAA+B,MAAnC,EAA2C;AACzC,UAAI,IAAI,MAAJ,EAAY,WAAZ,MAA6B,aAAjC,EAAgD;AAC9C,eAAO,eAAK,IAAL,CAAU,MAAM,WAAhB,EAA6B,IAAI,MAAJ,CAA7B,CAAP;AACD;AACF;AACD,WAAO,GAAP;AACD,G","file":"image.js","sourcesContent":["import Base from './base.js'\r\nimport path from 'path';\r\n\r\nvar URI = require(\"uri-js\");\r\n/**\r\n * model\r\n */\r\nexport default class extends Base {\r\n\r\n  async getImages(imageId) {\r\n    let images;\r\n    if (!(imageId instanceof Array))\r\n      imageId = [imageId];\r\n    images = await this.where({id: [\"IN\", imageId]}).select();\r\n    for (let i of images) {\r\n      i[\"realPath\"] = this.translatePath(i[\"path\"]);\r\n    }\r\n    return images;\r\n  }\r\n\r\n  translatePath(oldPath) {\r\n    let res = URI.parse(oldPath);\r\n    if (res[\"scheme\"].toLowerCase() == \"file\") {\r\n      if (res[\"host\"].toLowerCase() == \"upload_path\") {\r\n        return path.join(think.UPLOAD_PATH, res[\"path\"]);\r\n      }\r\n    }\r\n    return res;\r\n  }\r\n\r\n}"]}