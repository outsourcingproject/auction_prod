{"version":3,"sources":["../../../src/api/model/image.js"],"names":["URI","require","getImages","imageId","images","Array","where","id","select","i","translatePath","oldPath","res","parse","toLowerCase","join","think","UPLOAD_PATH"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAIA,MAAMC,QAAQ,QAAR,CAAV;AACA;;;;;;;;;;;;mBAKQC,S;2FAAUC,O;;;;;;;AACVC,oB;;AACJ,kBAAI,EAAED,mBAAmBE,KAArB,CAAJ,EACEF,UAAU,CAACA,OAAD,CAAV;;qBACa,KAAKG,KAAL,CAAW,EAACC,IAAI,CAAC,IAAD,EAAOJ,OAAP,CAAL,EAAX,EAAkCK,MAAlC,E;;;AAAfJ,oB;0BACcA,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAALK,e;;AACPA,gBAAE,UAAF,IAAgB,KAAKC,aAAL,CAAmBD,EAAE,MAAF,CAAnB,CAAhB;;;;;;;+CAEKL,M;;;;;;;;;;;;;;;;;mBAGTM,a,0BAAcC,O,EAAS;AACrB,QAAIC,MAAMZ,IAAIa,KAAJ,CAAUF,OAAV,CAAV;AACA,QAAIC,IAAI,QAAJ,EAAcE,WAAd,MAA+B,MAAnC,EAA2C;AACzC,UAAIF,IAAI,MAAJ,EAAYE,WAAZ,MAA6B,aAAjC,EAAgD;AAC9C,eAAO,eAAKC,IAAL,CAAUC,MAAMC,WAAhB,EAA6BL,IAAI,MAAJ,CAA7B,CAAP;AACD;AACF;AACD,WAAOA,GAAP;AACD,G","file":"image.js","sourcesContent":["import Base from './base.js'\r\nimport path from 'path';\r\n\r\nvar URI = require(\"uri-js\");\r\n/**\r\n * model\r\n */\r\nexport default class extends Base {\r\n\r\n  async getImages(imageId) {\r\n    let images;\r\n    if (!(imageId instanceof Array))\r\n      imageId = [imageId];\r\n    images = await this.where({id: [\"IN\", imageId]}).select();\r\n    for (let i of images) {\r\n      i[\"realPath\"] = this.translatePath(i[\"path\"]);\r\n    }\r\n    return images;\r\n  }\r\n\r\n  translatePath(oldPath) {\r\n    let res = URI.parse(oldPath);\r\n    if (res[\"scheme\"].toLowerCase() == \"file\") {\r\n      if (res[\"host\"].toLowerCase() == \"upload_path\") {\r\n        return path.join(think.UPLOAD_PATH, res[\"path\"]);\r\n      }\r\n    }\r\n    return res;\r\n  }\r\n\r\n}"]}