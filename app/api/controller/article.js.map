{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\api\\controller\\article.js"
    ],
    "names": [],
    "mappings": "AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;;;;;;;;;;;;;AAGE;;;;mBAIA,W,0BAAa;AACX;AACA,WAAO,KAAK,OAAL,EAAP;AACD,G;;mBACK,Y;;;;;;;AACA,gB,GAAK,KAAK,KAAL,CAAW,IAAX,C;;qBACU,KAAK,KAAL,CAAW,SAAX,EAAsB,cAAtB,CAAqC,EAArC,C;;;AAAf,oB;;qBACgB,KAAK,cAAL,E;;;AAAhB,qB;AACA,iB,GAAM;AACN,2BAAU,QAAQ,OADZ;AAEN,4BAAW,QAAQ,QAFb;AAGN,0BAAS;AAHH,e;+CAKH,KAAK,OAAL,CAAa,GAAb,C;;;;;;;;;;;;;;;;;mBAGH,c;;;;;;;;AACE,uB,GAAY,C,EAAG;;AACf,8B,GAAmB,KAAK,KAAL,CAAW,cAAX,EAA0B,IAA1B,C;AACnB,sB,GAAW,E;;;qBAGP,iBAAiB,UAAjB,E;;;;qBACe,iBAAiB,OAAjB,E;;;AAAjB,sB;wDACS,Q;;;;;;;;AAAL,e;;qBACQ,iBAAiB,UAAjB,CAA4B,SAAS,CAAT,EAAY,IAAZ,CAA5B,C;;;AAAV,e;;AACJ,uBAAS,IAAT,CAAc,EAAE,CAAF,CAAd;;;;;;qBAEI,iBAAiB,MAAjB,E;;;;;;;;;;qBAGA,iBAAiB,QAAjB,E;;;AAGJ,2B,GAAgB,E;0BACL,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAL,gB;;AACR,iBAAE,SAAF,EAAa,GAAb,CAAiB,UAAC,EAAD;AAAA,uBAAM,cAAc,IAAd,CAAmB,EAAC,MAAK,GAAG,IAAH,CAAN,EAAe,SAAQ,GAAG,OAAH,CAAvB,EAAmC,SAAQ,GAAG,OAAH,CAA3C,EAAuD,QAAO,GAAG,UAAH,CAA9D,EAAnB,CAAN;AAAA,eAAjB;;;;;;;AAGE,iB,GAAK;AACP,2BAAU;AACR,0BAAO,CAAC,SAAS,CAAT,EAAY,MAAZ,CAAD,CADC;AAER,6BAAU,CAAC,cAAc,KAAd,CAAoB,CAApB,EAAsB,IAAE,SAAxB,CAAD;AAFF,iBADH;AAKP,4BAAW;AACT,0BAAO,CAAC,SAAS,CAAT,EAAY,MAAZ,CAAD,EAAqB,SAAS,CAAT,EAAY,MAAZ,CAArB,EAAyC,SAAS,CAAT,EAAY,MAAZ,CAAzC,CADE;AAET,6BAAU,CAAC,cAAc,KAAd,CAAoB,IAAE,SAAtB,EAAgC,IAAE,SAAlC,CAAD,EAA8C,cAAc,KAAd,CAAoB,IAAE,SAAtB,EAAgC,IAAE,SAAlC,CAA9C,EAA2F,cAAc,KAAd,CAAoB,IAAE,SAAtB,EAAgC,IAAE,SAAlC,CAA3F;AAFD;AALJ,e;gDAUF,G",
    "file": "..\\..\\..\\src\\api\\controller\\article.js",
    "sourcesContent": [
        "'use strict';\r\n\r\nimport Base from './base.js';\r\n\r\nexport default class extends Base {\r\n  /**\r\n   * index action\r\n   * @return {Promise} []\r\n   */\r\n  indexAction(){\r\n    //auto render template file index_index.html\r\n    return this.display();\r\n  }\r\n  async detailAction(){\r\n    let id = this.param(\"id\");\r\n    let detail = await this.model(\"article\").getDetailAdmin(id);\r\n    let tabdata = await this._tabdataHelper();\r\n    let res = {\r\n        \"lefttab\":tabdata.lefttab,\r\n        \"righttab\":tabdata.righttab,\r\n        \"detail\":detail\r\n    }\r\n    return this.success(res);\r\n  }\r\n\r\n  async _tabdataHelper(){\r\n      let detailNum = 6; //每个类别显示的新闻条数\r\n      let articleTypeModel = this.model('article_type',true);\r\n      let articles = [];\r\n      \r\n      try{\r\n        await articleTypeModel.startTrans();\r\n        let typeList = await articleTypeModel.getList();\r\n        for(var t in typeList){\r\n          let a = await articleTypeModel.selectData(typeList[t][\"id\"])\r\n          articles.push(a[0]);\r\n        }\r\n        await articleTypeModel.commit();\r\n\r\n      }catch(e){\r\n        await articleTypeModel.rollback();\r\n      }\r\n\r\n      let resultDetails = [];\r\n      for (let  a of articles){\r\n        a[\"article\"].map((aa)=>resultDetails.push({\"id\":aa[\"id\"],\"image\":aa[\"image\"],\"title\":aa[\"title\"],\"date\":aa[\"createAt\"]}));\r\n      }\r\n\r\n      let res ={\r\n        \"lefttab\":{\r\n          \"tabs\":[articles[0][\"name\"]],\r\n          \"details\":[resultDetails.slice(0,1*detailNum)]\r\n        },\r\n        \"righttab\":{\r\n          \"tabs\":[articles[1][\"name\"],articles[2][\"name\"],articles[3][\"name\"]],\r\n          \"details\":[resultDetails.slice(1*detailNum,2*detailNum),resultDetails.slice(2*detailNum,3*detailNum),resultDetails.slice(3*detailNum,4*detailNum)]      \r\n        }\r\n      };\r\n      return res;\r\n  }\r\n}"
    ]
}