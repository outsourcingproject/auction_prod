{"version":3,"sources":["../../../src/api/controller/home.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;;;;;;;;;;;;;AAGI;;;;;sBAKO,W;;;;;;;;AAEC,4C,GAAY,C,EAAG;AACrB;;;0CACqB,KAAK,KAAL,CAAW,cAAX,EAA2B,UAA3B,E;;;AAAjB,2C;;0CAGe,KAAK,KAAL,CAAW,YAAX,EAAyB,YAAzB,E;;;AAAf,yC;;0CAGmB,KAAK,KAAL,CAAW,SAAX,EAAsB,UAAtB,CAAiC,CAAjC,C;;;AAAjB,2C;+CAGW,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAL,oC;;AACT,qCAAE,SAAF,EAAa,GAAb,CAAiB,UAAC,EAAD,EAAM;AAAC,2CAAG,MAAH,IAAa,GAAG,UAAH,CAAb,EAA4B,OAAO,GAAG,UAAH,CAAnC;AAAkD,oCAA1E;;;;;;;gDAEY,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAL,oC;;AACP,qCAAE,MAAF,EAAU,GAAV,CAAc,UAAC,CAAD,EAAK;AAAC,0CAAE,OAAF,IAAW,EAAE,cAAF,CAAX,EAA6B,OAAO,EAAE,cAAF,CAApC;AAAsD,oCAA1E;AACG,qCAAE,OAAF,IAAa,EAAE,MAAF,CAAb,CAAwB,OAAO,EAAE,MAAF,CAAP;AACxB,qCAAE,UAAF,IAAgB,EAAE,MAAF,CAAhB,CAA2B,OAAO,EAAE,MAAF,CAAP;;;;;;;AAE7B,yC,GAAQ;AACX,mDAAU;AACT,qDAAO,CAAC,SAAS,CAAT,EAAY,MAAZ,CAAD,CADE;AAET,wDAAU,CAAC,SAAS,CAAT,EAAY,SAAZ,EAAuB,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAAD;AAFD,yCADC;AAKX,oDAAW;AACV,qDAAO,CAAC,SAAS,CAAT,EAAY,MAAZ,CAAD,EAAqB,SAAS,CAAT,EAAY,MAAZ,CAArB,EAAyC,SAAS,CAAT,EAAY,MAAZ,CAAzC,CADG;AAEV,wDAAU,CAAC,SAAS,CAAT,EAAY,SAAZ,EAAuB,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAAD,EACE,SAAS,CAAT,EAAY,SAAZ,EAAuB,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CADF,EAEE,SAAS,CAAT,EAAY,SAAZ,EAAuB,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAFF;AAFA,yCALA;AAWX,yDAAgB,MAXL;AAYX,mDAAU;AAZC,oC;;yCAcP,UAAQ,I;;;;;oEACH,KAAK,OAAL,CAAa,MAAb,C;;;oEAEA,KAAK,IAAL,CAAU,QAAV,C","file":"home.js","sourcesContent":["'use strict';\r\n\r\nimport Base from './base.js';\r\n\r\nexport default class extends Base {\r\n    /**\r\n     * index action\r\n     * @return {Promise} []\r\n     */\r\n\r\n     async indexAction(){\r\n\r\n        let detailNum = 6; //文章数量\r\n     \t// get article on home page\r\n     \tlet articles = await this.model('article_type').getArticle();\r\n\r\n     \t//get item groups on home page\r\n     \tlet groups = await this.model('item_group').getGroupItem();\r\n\r\n     \t//get services on home page\r\n        let services = await this.model('service').selectData(4);\r\n\r\n        //format data\r\n        for (let  a of articles){\r\n        \ta[\"article\"].map((aa)=>{aa[\"date\"] = aa[\"createAt\"],delete aa[\"createAt\"]});\r\n        }\r\n        for(let g of groups){\r\n        \tg[\"item\"].map((i)=>{i[\"price\"]=i[\"currentPrice\"],delete i[\"currentPrice\"]});\r\n            g[\"title\"] = g[\"name\"]; delete g[\"name\"];\r\n            g[\"auctions\"] = g[\"item\"]; delete g[\"item\"];\r\n        }\r\n     \tlet result ={\r\n     \t\t\"lefttab\":{\r\n     \t\t\t\"tabs\":[articles[0][\"name\"]],\r\n     \t\t\t\"details\":[articles[0][\"article\"].slice(0,6)]\r\n     \t\t},\r\n     \t\t\"righttab\":{\r\n     \t\t\t\"tabs\":[articles[1][\"name\"],articles[2][\"name\"],articles[3][\"name\"]],\r\n     \t\t\t\"details\":[articles[1][\"article\"].slice(0,6), \r\n                    articles[2][\"article\"].slice(0,6), \r\n                    articles[3][\"article\"].slice(0,6)] \t\t\t\r\n     \t\t},\r\n     \t\t\"auctionGroups\":groups,\r\n     \t\t\"service\":services\r\n     \t}\r\n        if(result!=null)\r\n        \treturn this.success(result);\r\n        else\r\n        \treturn this.fail(\"无相关数据！\");\r\n     }\r\n}"]}