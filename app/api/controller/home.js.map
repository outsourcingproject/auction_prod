{"version":3,"sources":["../../../src/api/controller/home.js"],"names":["indexAction","detailNum","model","getArticle","articles","getGroupItem","groups","selectData","services","a","map","aa","g","i","result","slice","success","fail"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;;;;;;;;;;;;;AAGI;;;;;sBAKOA,W;;;;;;;;AAECC,4C,GAAY,C,EAAG;AACrB;;;0CACqB,KAAKC,KAAL,CAAW,cAAX,EAA2BC,UAA3B,E;;;AAAjBC,2C;;0CAGe,KAAKF,KAAL,CAAW,YAAX,EAAyBG,YAAzB,E;;;AAAfC,yC;;0CAGmB,KAAKJ,KAAL,CAAW,SAAX,EAAsBK,UAAtB,CAAiC,CAAjC,C;;;AAAjBC,2C;+CAGWJ,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAALK,oC;;AACTA,qCAAE,SAAF,EAAaC,GAAb,CAAiB,UAACC,EAAD,EAAM;AAACA,2CAAG,MAAH,IAAaA,GAAG,UAAH,CAAb,EAA4B,OAAOA,GAAG,UAAH,CAAnC;AAAkD,oCAA1E;;;;;;;gDAEYL,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAALM,oC;;AACPA,qCAAE,MAAF,EAAUF,GAAV,CAAc,UAACG,CAAD,EAAK;AAACA,0CAAE,OAAF,IAAWA,EAAE,cAAF,CAAX,EAA6B,OAAOA,EAAE,cAAF,CAApC;AAAsD,oCAA1E;AACGD,qCAAE,OAAF,IAAaA,EAAE,MAAF,CAAb,CAAwB,OAAOA,EAAE,MAAF,CAAP;AACxBA,qCAAE,UAAF,IAAgBA,EAAE,MAAF,CAAhB,CAA2B,OAAOA,EAAE,MAAF,CAAP;;;;;;;AAE7BE,yC,GAAQ;AACX,mDAAU;AACT,qDAAO,CAACV,SAAS,CAAT,EAAY,MAAZ,CAAD,CADE;AAET,wDAAU,CAACA,SAAS,CAAT,EAAY,SAAZ,EAAuBW,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAAD;AAFD,yCADC;AAKX,oDAAW;AACV,qDAAO,CAACX,SAAS,CAAT,EAAY,MAAZ,CAAD,EAAqBA,SAAS,CAAT,EAAY,MAAZ,CAArB,EAAyCA,SAAS,CAAT,EAAY,MAAZ,CAAzC,CADG;AAEV,wDAAU,CAACA,SAAS,CAAT,EAAY,SAAZ,EAAuBW,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAAD,EACEX,SAAS,CAAT,EAAY,SAAZ,EAAuBW,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CADF,EAEEX,SAAS,CAAT,EAAY,SAAZ,EAAuBW,KAAvB,CAA6B,CAA7B,EAA+B,CAA/B,CAFF;AAFA,yCALA;AAWX,yDAAgBT,MAXL;AAYX,mDAAUE;AAZC,oC;;yCAcPM,UAAQ,I;;;;;oEACH,KAAKE,OAAL,CAAaF,MAAb,C;;;oEAEA,KAAKG,IAAL,CAAU,QAAV,C","file":"home.js","sourcesContent":["'use strict';\r\n\r\nimport Base from './base.js';\r\n\r\nexport default class extends Base {\r\n    /**\r\n     * index action\r\n     * @return {Promise} []\r\n     */\r\n\r\n     async indexAction(){\r\n\r\n        let detailNum = 6; //文章数量\r\n     \t// get article on home page\r\n     \tlet articles = await this.model('article_type').getArticle();\r\n\r\n     \t//get item groups on home page\r\n     \tlet groups = await this.model('item_group').getGroupItem();\r\n\r\n     \t//get services on home page\r\n        let services = await this.model('service').selectData(4);\r\n\r\n        //format data\r\n        for (let  a of articles){\r\n        \ta[\"article\"].map((aa)=>{aa[\"date\"] = aa[\"createAt\"],delete aa[\"createAt\"]});\r\n        }\r\n        for(let g of groups){\r\n        \tg[\"item\"].map((i)=>{i[\"price\"]=i[\"currentPrice\"],delete i[\"currentPrice\"]});\r\n            g[\"title\"] = g[\"name\"]; delete g[\"name\"];\r\n            g[\"auctions\"] = g[\"item\"]; delete g[\"item\"];\r\n        }\r\n     \tlet result ={\r\n     \t\t\"lefttab\":{\r\n     \t\t\t\"tabs\":[articles[0][\"name\"]],\r\n     \t\t\t\"details\":[articles[0][\"article\"].slice(0,6)]\r\n     \t\t},\r\n     \t\t\"righttab\":{\r\n     \t\t\t\"tabs\":[articles[1][\"name\"],articles[2][\"name\"],articles[3][\"name\"]],\r\n     \t\t\t\"details\":[articles[1][\"article\"].slice(0,6), \r\n                    articles[2][\"article\"].slice(0,6), \r\n                    articles[3][\"article\"].slice(0,6)] \t\t\t\r\n     \t\t},\r\n     \t\t\"auctionGroups\":groups,\r\n     \t\t\"service\":services\r\n     \t}\r\n        if(result!=null)\r\n        \treturn this.success(result);\r\n        else\r\n        \treturn this.fail(\"无相关数据！\");\r\n     }\r\n}"]}