{"version":3,"sources":["../../../src/common/controller/error.js"],"names":[],"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIE;;;;;mBAKA,gB,6BAAiB,M,EAAO;;AAEtB,QAAI,cAAc,KAAK,MAAL,CAAY,OAAZ,CAAlB;AACA,QAAI,UAAU,KAAK,IAAL,CAAU,KAAV,IAAmB,KAAK,IAAL,CAAU,KAAV,CAAgB,OAAnC,IAA8C,OAA5D;AACA,QAAG,KAAK,OAAL,EAAH,EAAkB;AAAA;;AAChB,aAAO,KAAK,KAAL,sBACJ,YAAY,GADR,IACc,MADd,SAEJ,YAAY,GAFR,IAEc,OAFd,UAAP;AAID,KALD,MAKM,IAAG,KAAK,MAAL,EAAH,EAAiB;AACrB,aAAO,KAAK,IAAL,CAAU,MAAV,EAAkB,OAAlB,CAAP;AACD;;AAED,QAAI,SAAS,QAAb;AACA,QAAG,MAAM,IAAN,KAAe,MAAM,WAAxB,EAAoC;AAClC,eAAS,KAAK,MAAL,CAAY,gBAAZ,CAAT;AACD;AACD,QAAI,OAAU,MAAV,eAA0B,MAA1B,UAAJ;AACA,QAAI,UAAU,KAAK,MAAL,CAAY,KAAZ,CAAd;AACA,cAAU,MAAM,MAAN,CAAa,EAAb,EAAiB,OAAjB,EAA0B,EAAC,MAAM,KAAP,EAA1B,CAAV;AACA,WAAO,KAAK,OAAL,CAAa,IAAb,EAAmB,OAAnB,CAAP;AACD,G;AACD;;;;;;mBAIA,U,yBAAY;AACV,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACD,G;AACD;;;;;;mBAIA,U,yBAAY;AACV,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACD,G;AACD;;;;;;mBAIA,U,yBAAY;AACV,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACD,G;AACD;;;;;;mBAIA,U,yBAAY;AACV,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACD,G;AACD;;;;;;mBAIA,U,yBAAY;AACV,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACD,G;;;EA9D0B,MAAM,UAAN,CAAiB,I","file":"error.js","sourcesContent":["'use strict';\r\n/**\r\n * error controller\r\n */\r\nexport default class extends think.controller.base {\r\n  /**\r\n   * display error page\r\n   * @param  {Number} status []\r\n   * @return {Promise}        []\r\n   */\r\n  displayErrorPage(status){\r\n\r\n    let errorConfig = this.config('error');\r\n    let message = this.http.error && this.http.error.message || 'error';\r\n    if(this.isJsonp()){\r\n      return this.jsonp({\r\n        [errorConfig.key]: status,\r\n        [errorConfig.msg]: message\r\n      })\r\n    }else if(this.isAjax()){\r\n      return this.fail(status, message);\r\n    }\r\n\r\n    let module = 'common';\r\n    if(think.mode !== think.mode_module){\r\n      module = this.config('default_module');\r\n    }\r\n    let file = `${module}/error/${status}.html`;\r\n    let options = this.config('tpl');\r\n    options = think.extend({}, options, {type: 'ejs'});\r\n    return this.display(file, options);\r\n  }\r\n  /**\r\n   * Bad Request \r\n   * @return {Promise} []\r\n   */\r\n  _400Action(){\r\n    return this.displayErrorPage(400);\r\n  }\r\n  /**\r\n   * Forbidden \r\n   * @return {Promise} []\r\n   */\r\n  _403Action(){\r\n    return this.displayErrorPage(403);\r\n  }\r\n  /**\r\n   * Not Found \r\n   * @return {Promise}      []\r\n   */\r\n  _404Action(){\r\n    return this.displayErrorPage(404);\r\n  }\r\n  /**\r\n   * Internal Server Error\r\n   * @return {Promise}      []\r\n   */\r\n  _500Action(){\r\n    return this.displayErrorPage(500);\r\n  }\r\n  /**\r\n   * Service Unavailable\r\n   * @return {Promise}      []\r\n   */\r\n  _503Action(){\r\n    return this.displayErrorPage(503);\r\n  }\r\n}"]}